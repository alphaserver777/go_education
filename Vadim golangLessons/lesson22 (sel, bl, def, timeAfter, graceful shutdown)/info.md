1. select - block, unblock, default

1) В первую очередь select выбирает НЕБЛОКИРУЮЩУЮ операцию. Если их несколько, то рандомно выбирается.
2) Если есть default - вызывает ДЕФОЛТ
3) Если есть block операции - то блокируемся и ждём пока unblock разблокируется.

2. time.After (метод After)

(select выбирает между ожиданием получения результата операции (к примеру - выполнение цикла) и истечением таймера. Если таймер срабатывает раньше, чем завершается операция (работа цикла), то выводится сообщение о таймауте.)

3. graceful shutdown

"Graceful shutdown" (или "плавное завершение") в контексте программного обеспечения, особенно серверов и сетевых приложений, означает процесс корректного и контролируемого завершения работы приложения, при котором оно:

1. Прекращает принимать новые запросы: Приложение перестает принимать новые соединения или обрабатывать новые запросы.
2. Завершает обработку текущих запросов: Приложение дожидается завершения обработки всех текущих запросов или задач.
3. Освобождает ресурсы: Приложение освобождает все выделенные ресурсы (память, соединения с базами данных, файловые дескрипторы и т. д.)
4. Корректно выходит: Приложение завершает свою работу без ошибок и не оставляет за собой "мусор".

Зачем нужно плавное завершение?

• Избежание ошибок: Если приложение завершается резко, не дожидаясь завершения обработки текущих запросов, это может привести к потере данных, повреждению файлов или нестабильности системы.
• Сохранность данных: Плавное завершение гарантирует, что все данные будут сохранены и обработаны корректно.
• Корректное освобождение ресурсов: Приложение корректно освобождает все занятые ресурсы, предотвращая утечки памяти и другие проблемы.
• Улучшение доступности: Плавное завершение позволяет клиентам корректно завершить свои запросы и переключиться на другой сервер, если это необходимо.
• Удобство перезапуска: Плавное завершение обеспечивает более надежный перезапуск приложения, так как все ресурсы будут освобождены корректно.

Как реализовать плавное завершение в Go:

В Go, плавное завершение обычно реализуется с использованием следующих механизмов:

1. Обработка сигналов операционной системы: Используется пакет os/signal для перехвата сигналов, таких как SIGINT (Ctrl+C) и SIGTERM (сигнал завершения).
2. Использование context.Context: Используется context.Context для передачи сигнала отмены во все горутины и для управления таймаутами.
3. Закрытие слушающих сокетов: http.Server предоставляет метод Shutdown для корректного завершения приема новых соединений.
4. sync.WaitGroup для ожидания горутин: sync.WaitGroup используется для ожидания завершения всех горутин, которые обрабатывают запросы.
